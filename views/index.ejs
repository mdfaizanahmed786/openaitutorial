<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Your GPT</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <h2 class="text-center" style="margin-top: 30px">Your GPT</h2>

    <form
      method="post"
      action="/ask-gpt"
      class=" mt-4"
      style=" margin: 0px 40px;"
    >
      <div class="form-floating">
        <textarea
          name="message"
          id="message"
          class="form-control"
          placeholder="Leave a comment here"
          id="floatingTextarea"
        ></textarea>
        <label for="floatingTextarea">Enter your query here!!</label>
      </div>
      <button
        type="submit"
        onclick="submitToGPT(e)"
        class="btn btn-primary mt-3"
      >
       Submit
      </button>
    </form>

    <h3 class="mx-3 mt-4">Your response:<h4 class="mx-3"><%= data %></h4> </h3>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
      crossorigin="anonymous"
    ></script>
  </body>

  <script>
    const message = document.querySelector("#message");

    const getData = async () => {
      const response = await fetch("http://localhost:3000/ask-gpt", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: {
          message: message.textContent,
        },
      });
      const data = await response.json();
      return data;
    };

    const submitToGPT = async (e) => {
      e.preventDefault();
      await getData();
    };
  </script>
</html>
